{
    "sourceFile": "comment-unused-vars.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1740852503908,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1740852503908,
            "name": "Commit-0",
            "content": "import { execSync } from 'child_process';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { fileURLToPath } from 'url';\r\n\r\n// Get current directory\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = path.dirname(__filename);\r\n\r\nconsole.log('ðŸ” Finding and commenting out unused variables...');\r\n\r\n// Generate a report of unused variables using ESLint\r\ntry {\r\n  // Run ESLint to identify unused variables\r\n  const output = execSync(\r\n    'npx eslint --quiet \"src/**/*.tsx\" \"src/**/*.ts\" --rule \"no-unused-vars: error\" --rule \"@typescript-eslint/no-unused-vars: error\" --format json',\r\n    { encoding: 'utf-8' }\r\n  );\r\n  \r\n  const results = JSON.parse(output);\r\n  const fileProblems = new Map();\r\n  \r\n  // Group problems by file\r\n  results.forEach(result => {\r\n    const { filePath, messages } = result;\r\n    \r\n    // Filter for unused variables\r\n    const unusedVars = messages.filter(msg => \r\n      (msg.ruleId === 'no-unused-vars' || msg.ruleId === '@typescript-eslint/no-unused-vars')\r\n    );\r\n    \r\n    if (unusedVars.length > 0) {\r\n      fileProblems.set(filePath, unusedVars);\r\n    }\r\n  });\r\n  \r\n  console.log(`Found unused variables in ${fileProblems.size} files.`);\r\n  \r\n  // Process each file\r\n  let totalCommentsAdded = 0;\r\n  \r\n  for (const [filePath, problems] of fileProblems) {\r\n    console.log(`Processing ${path.relative(__dirname, filePath)}`);\r\n    \r\n    let content = fs.readFileSync(filePath, 'utf8');\r\n    const lines = content.split('\\n');\r\n    \r\n    // Sort problems by line number in descending order to avoid offset issues\r\n    problems.sort((a, b) => b.line - a.line);\r\n    \r\n    for (const problem of problems) {\r\n      const { line, message } = problem;\r\n      const lineIndex = line - 1;\r\n      \r\n      // Extract the variable name from the error message\r\n      const match = message.match(/'([^']+)' is defined but never used/);\r\n      if (!match) continue;\r\n      \r\n      const unusedVar = match[1];\r\n      const lineContent = lines[lineIndex];\r\n      \r\n      // Skip if this is an import (already handled by the other script)\r\n      if (lineContent.includes('import ')) {\r\n        continue;\r\n      }\r\n      \r\n      // Handle variable declarations (const, let, var)\r\n      if (/\\b(const|let|var)\\s+(\\w+|\\{[^}]*\\}|\\[[^\\]]*\\])\\s*=/.test(lineContent)) {\r\n        // If it's a destructuring assignment like: const { a, b, c } = obj\r\n        if (lineContent.includes(`{ ${unusedVar}`) || lineContent.includes(`, ${unusedVar}`) || lineContent.includes(`${unusedVar},`)) {\r\n          // Comment out just the unused variable in the destructuring\r\n          const parts = lineContent.split(/[{,}]/g);\r\n          let newLineContent = '';\r\n          let inBraces = false;\r\n          \r\n          for (let i = 0; i < parts.length; i++) {\r\n            let part = parts[i];\r\n            \r\n            if (part.includes('{')) {\r\n              inBraces = true;\r\n              newLineContent += part;\r\n              continue;\r\n            }\r\n            \r\n            if (part.includes('}')) {\r\n              inBraces = false;\r\n              newLineContent += part;\r\n              continue;\r\n            }\r\n            \r\n            if (inBraces && part.trim() === unusedVar) {\r\n              newLineContent += `/* ${part} */`;\r\n            } else {\r\n              newLineContent += part;\r\n            }\r\n            \r\n            if (i < parts.length - 1 && !parts[i+1].includes('}')) {\r\n              newLineContent += ',';\r\n            }\r\n          }\r\n          \r\n          lines[lineIndex] = newLineContent;\r\n        } else if (lineContent.match(new RegExp(`\\\\b(const|let|var)\\\\s+${unusedVar}\\\\s*=`))) {\r\n          // For simple variable declarations: const name = value\r\n          lines[lineIndex] = `// ${lineContent} // Unused variable`;\r\n        }\r\n        \r\n        totalCommentsAdded++;\r\n      }\r\n      \r\n      // Handle function parameters\r\n      else if (/function\\s+\\w+\\s*\\([^)]*\\)/.test(lineContent) && lineContent.includes(unusedVar)) {\r\n        // Comment out the parameter by adding an underscore prefix (TypeScript convention)\r\n        lines[lineIndex] = lineContent.replace(\r\n          new RegExp(`\\\\b${unusedVar}\\\\b`),\r\n          `_${unusedVar} /* Unused parameter */`\r\n        );\r\n        totalCommentsAdded++;\r\n      }\r\n      \r\n      // Handle function arguments in arrow functions: (a, b) => {}\r\n      else if (/\\([^)]*\\)\\s*=>/.test(lineContent) && lineContent.includes(unusedVar)) {\r\n        // Comment out the parameter by adding an underscore prefix\r\n        lines[lineIndex] = lineContent.replace(\r\n          new RegExp(`\\\\b${unusedVar}\\\\b`),\r\n          `_${unusedVar} /* Unused parameter */`\r\n        );\r\n        totalCommentsAdded++;\r\n      }\r\n      \r\n      // Handle interface properties and type declarations\r\n      else if ((/interface\\s+\\w+/.test(lineContent) || /type\\s+\\w+\\s*=/.test(lineContent)) \r\n        && lineContent.includes(unusedVar)) {\r\n          // This is a bit risky, so we'll just add a comment\r\n          lines[lineIndex] = `${lineContent} /* Contains unused property: ${unusedVar} */`;\r\n          totalCommentsAdded++;\r\n      }\r\n    }\r\n    \r\n    // Write the updated content back to the file\r\n    fs.writeFileSync(filePath, lines.join('\\n'), 'utf8');\r\n  }\r\n  \r\n  console.log(`âœ… Added comments to ${totalCommentsAdded} unused variables across ${fileProblems.size} files.`);\r\n  console.log('ðŸŽ‰ Done! Now try running your build command.');\r\n  \r\n} catch (error) {\r\n  console.error('Error:', error.message);\r\n  console.error('Make sure ESLint is properly installed and configured.');\r\n} "
        }
    ]
}