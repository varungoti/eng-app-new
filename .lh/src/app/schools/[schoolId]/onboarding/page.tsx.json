{
    "sourceFile": "src/app/schools/[schoolId]/onboarding/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 17,
            "patches": [
                {
                    "date": 1739438105112,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1739438232623,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n import { useEffect } from 'react';\r\n import { useParams } from 'next/navigation';\r\n import { useOnboarding } from '@/hooks/useOnboarding';\r\n import OnboardingProgress from '@/components/OnboardingProgress';\r\n-import { OnboardingSteps  from '@/components/school/OnboardingSteps';\r\n+import OnboardingSteps from '@/components/school/OnboardingSteps';\r\n import { LoadingSpinner } from '@/components/ui/loading-spinner';\r\n \r\n export default function SchoolOnboardingPage() {\r\n   const { schoolId } = useParams();\r\n@@ -74,9 +74,9 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-        currentStep={stats?.completedTasks || 0}\r\n+        step={stats?.completedTasks || 0}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1739438244269,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,9 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-        step={stats?.completedTasks || 0}\r\n+        currentStep={stats?.completedTasks || 0}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1739438263956,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,8 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-        currentStep={stats?.completedTasks || 0}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1739438295586,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,8 +74,9 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n+        currentStep={stats?.completedTasks || 0}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1739438309453,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,12 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-        currentStep={stats?.completedTasks || 0}\r\n+<<<<<<< Tabnine <<<<<<<\r\n+        currentStep={stats?.completedTasks || 0}//-\r\n+        currentStep={stats?.completedTasks ?? 0}//+\r\n+>>>>>>> Tabnine >>>>>>>// {\"conversationId\":\"916c80f2-b832-4853-bbb4-369a0f4647da\",\"source\":\"instruct\"}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1739438315914,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,12 +74,9 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-<<<<<<< Tabnine <<<<<<<\r\n-        currentStep={stats?.completedTasks || 0}//-\r\n-        currentStep={stats?.completedTasks ?? 0}//+\r\n->>>>>>> Tabnine >>>>>>>// {\"conversationId\":\"916c80f2-b832-4853-bbb4-369a0f4647da\",\"source\":\"instruct\"}\r\n+        currentStep={stats?.completedTasks ?? 0}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1739438326328,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,12 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-        currentStep={stats?.completedTasks ?? 0}\r\n+<<<<<<< Tabnine <<<<<<<\r\n+        currentStep={stats?.completedTasks || 0}//-\r\n+        currentStep={stats?.completedTasks ?? 0}//+\r\n+>>>>>>> Tabnine >>>>>>>// {\"conversationId\":\"916c80f2-b832-4853-bbb4-369a0f4647da\",\"source\":\"instruct\"}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1740947870094,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,12 +74,9 @@\n \r\n       {/* Onboarding Steps */}\r\n       <OnboardingSteps\r\n         schoolId={schoolId as string}\r\n-<<<<<<< Tabnine <<<<<<<\r\n-        currentStep={stats?.completedTasks || 0}//-\r\n-        currentStep={stats?.completedTasks ?? 0}//+\r\n->>>>>>> Tabnine >>>>>>>// {\"conversationId\":\"916c80f2-b832-4853-bbb4-369a0f4647da\",\"source\":\"instruct\"}\r\n+        currentStep={stats?.completedTasks || 0}\r\n         onStepComplete={refresh}\r\n       />\r\n \r\n       {/* Task Progress */}\r\n"
                },
                {
                    "date": 1740947886906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,26 +12,25 @@\n   const { \r\n     tasks, \r\n     progress, \r\n     stats, \r\n-    loading, \r\n-    error,\r\n-    updateProgress,\r\n-    refresh \r\n+    isLoading, \r\n+    documents,\r\n+    fetchOnboardingData: refresh\r\n   } = useOnboarding(schoolId as string);\r\n \r\n   useEffect(() => {\r\n     refresh();\r\n-  }, [schoolId]);\r\n+  }, [schoolId, refresh]);\r\n \r\n-  if (loading) {\r\n+  if (isLoading) {\r\n     return <LoadingSpinner />;\r\n   }\r\n \r\n-  if (error) {\r\n+  if (!tasks || !stats) {\r\n     return (\r\n       <div className=\"p-4 bg-red-50 rounded-lg\">\r\n-        <p className=\"text-red-600\">{error}</p>\r\n+        <p className=\"text-red-600\">Failed to load onboarding data</p>\r\n       </div>\r\n     );\r\n   }\r\n \r\n@@ -83,9 +82,9 @@\n       <div className=\"mt-8\">\r\n         <OnboardingProgress\r\n           tasks={tasks}\r\n           progress={progress}\r\n-          onUpdateProgress={updateProgress}\r\n+          onUpdateProgress={refresh}\r\n         />\r\n       </div>\r\n     </div>\r\n   );\r\n"
                },
                {
                    "date": 1740947935646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n \"use client\";\r\n \r\n import { useEffect } from 'react';\r\n import { useParams } from 'next/navigation';\r\n-import { useOnboarding } from '@/hooks/useOnboarding';\r\n+import { useOnboardingWithSchoolId } from '@/hooks/useOnboarding';\r\n import OnboardingProgress from '@/components/OnboardingProgress';\r\n import OnboardingSteps from '@/components/school/OnboardingSteps';\r\n import { LoadingSpinner } from '@/components/ui/loading-spinner';\r\n \r\n@@ -12,18 +12,19 @@\n   const { \r\n     tasks, \r\n     progress, \r\n     stats, \r\n-    isLoading, \r\n-    documents,\r\n-    fetchOnboardingData: refresh\r\n-  } = useOnboarding(schoolId as string);\r\n+    loading, \r\n+    error,\r\n+    updateProgress,\r\n+    refresh \r\n+  } = useOnboardingWithSchoolId(schoolId as string);\r\n \r\n   useEffect(() => {\r\n     refresh();\r\n   }, [schoolId, refresh]);\r\n \r\n-  if (isLoading) {\r\n+  if (loading) {\r\n     return <LoadingSpinner />;\r\n   }\r\n \r\n   if (!tasks || !stats) {\r\n"
                },
                {
                    "date": 1740947952630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,92 +1,92 @@\n-\"use client\";\r\n-\r\n-import { useEffect } from 'react';\r\n-import { useParams } from 'next/navigation';\r\n-import { useOnboardingWithSchoolId } from '@/hooks/useOnboarding';\r\n-import OnboardingProgress from '@/components/OnboardingProgress';\r\n-import OnboardingSteps from '@/components/school/OnboardingSteps';\r\n-import { LoadingSpinner } from '@/components/ui/loading-spinner';\r\n-\r\n-export default function SchoolOnboardingPage() {\r\n-  const { schoolId } = useParams();\r\n-  const { \r\n-    tasks, \r\n-    progress, \r\n-    stats, \r\n-    loading, \r\n-    error,\r\n-    updateProgress,\r\n-    refresh \r\n-  } = useOnboardingWithSchoolId(schoolId as string);\r\n-\r\n-  useEffect(() => {\r\n-    refresh();\r\n-  }, [schoolId, refresh]);\r\n-\r\n-  if (loading) {\r\n-    return <LoadingSpinner />;\r\n-  }\r\n-\r\n-  if (!tasks || !stats) {\r\n-    return (\r\n-      <div className=\"p-4 bg-red-50 rounded-lg\">\r\n-        <p className=\"text-red-600\">Failed to load onboarding data</p>\r\n-      </div>\r\n-    );\r\n-  }\r\n-\r\n-  return (\r\n-    <div className=\"max-w-4xl mx-auto py-8 px-4\">\r\n-      <div className=\"mb-8\">\r\n-        <h1 className=\"text-2xl font-bold text-gray-900\">School Onboarding</h1>\r\n-        <p className=\"text-gray-600\">Complete these steps to set up your school</p>\r\n-      </div>\r\n-\r\n-      {/* Progress Overview */}\r\n-      <div className=\"mb-8 p-4 bg-white rounded-lg shadow\">\r\n-        <div className=\"grid grid-cols-4 gap-4\">\r\n-          <div>\r\n-            <p className=\"text-sm text-gray-600\">Overall Progress</p>\r\n-            <p className=\"text-2xl font-semibold text-primary\">\r\n-              {Math.round(stats?.progress || 0)}%\r\n-            </p>\r\n-          </div>\r\n-          <div>\r\n-            <p className=\"text-sm text-gray-600\">Completed Tasks</p>\r\n-            <p className=\"text-2xl font-semibold text-green-600\">\r\n-              {stats?.completedTasks || 0}\r\n-            </p>\r\n-          </div>\r\n-          <div>\r\n-            <p className=\"text-sm text-gray-600\">Pending Tasks</p>\r\n-            <p className=\"text-2xl font-semibold text-yellow-600\">\r\n-              {stats?.pendingTasks || 0}\r\n-            </p>\r\n-          </div>\r\n-          <div>\r\n-            <p className=\"text-sm text-gray-600\">Required Remaining</p>\r\n-            <p className=\"text-2xl font-semibold text-red-600\">\r\n-              {stats?.remainingRequired || 0}\r\n-            </p>\r\n-          </div>\r\n-        </div>\r\n-      </div>\r\n-\r\n-      {/* Onboarding Steps */}\r\n-      <OnboardingSteps\r\n-        schoolId={schoolId as string}\r\n-        currentStep={stats?.completedTasks || 0}\r\n-        onStepComplete={refresh}\r\n-      />\r\n-\r\n-      {/* Task Progress */}\r\n-      <div className=\"mt-8\">\r\n-        <OnboardingProgress\r\n-          tasks={tasks}\r\n-          progress={progress}\r\n-          onUpdateProgress={refresh}\r\n-        />\r\n-      </div>\r\n-    </div>\r\n-  );\r\n+\"use client\";\n+\n+import { useEffect } from 'react';\n+import { useParams } from 'next/navigation';\n+import { useOnboardingWithSchoolId } from '@/hooks/useOnboarding';\n+import OnboardingProgress from '@/components/OnboardingProgress';\n+import OnboardingSteps from '@/components/school/OnboardingSteps';\n+import { LoadingSpinner } from '@/components/ui/loading-spinner';\n+\n+export default function SchoolOnboardingPage() {\n+  const { schoolId } = useParams();\n+  const { \n+    tasks, \n+    progress, \n+    stats, \n+    loading, \n+    error,\n+    updateProgress,\n+    refresh \n+  } = useOnboardingWithSchoolId(schoolId as string);\n+\n+  useEffect(() => {\n+    refresh();\n+  }, [schoolId, refresh]);\n+\n+  if (loading) {\n+    return <LoadingSpinner />;\n+  }\n+\n+  if (!tasks || !stats) {\n+    return (\n+      <div className=\"p-4 bg-red-50 rounded-lg\">\n+        <p className=\"text-red-600\">Failed to load onboarding data</p>\n+      </div>\n+    );\n+  }\n+\n+  return (\n+    <div className=\"max-w-4xl mx-auto py-8 px-4\">\n+      <div className=\"mb-8\">\n+        <h1 className=\"text-2xl font-bold text-gray-900\">School Onboarding</h1>\n+        <p className=\"text-gray-600\">Complete these steps to set up your school</p>\n+      </div>\n+\n+      {/* Progress Overview */}\n+      <div className=\"mb-8 p-4 bg-white rounded-lg shadow\">\n+        <div className=\"grid grid-cols-4 gap-4\">\n+          <div>\n+            <p className=\"text-sm text-gray-600\">Overall Progress</p>\n+            <p className=\"text-2xl font-semibold text-primary\">\n+              {Math.round(stats?.progress || 0)}%\n+            </p>\n+          </div>\n+          <div>\n+            <p className=\"text-sm text-gray-600\">Completed Tasks</p>\n+            <p className=\"text-2xl font-semibold text-green-600\">\n+              {stats?.completedTasks || 0}\n+            </p>\n+          </div>\n+          <div>\n+            <p className=\"text-sm text-gray-600\">Pending Tasks</p>\n+            <p className=\"text-2xl font-semibold text-yellow-600\">\n+              {stats?.pendingTasks || 0}\n+            </p>\n+          </div>\n+          <div>\n+            <p className=\"text-sm text-gray-600\">Required Remaining</p>\n+            <p className=\"text-2xl font-semibold text-red-600\">\n+              {stats?.remainingRequired || 0}\n+            </p>\n+          </div>\n+        </div>\n+      </div>\n+\n+      {/* Onboarding Steps */}\n+      <OnboardingSteps\n+        schoolId={schoolId as string}\n+        currentStep={stats?.completedTasks || 0}\n+        onStepComplete={refresh}\n+      />\n+\n+      {/* Task Progress */}\n+      <div className=\"mt-8\">\n+        <OnboardingProgress\n+          tasks={tasks}\n+          progress={progress}\n+          onUpdateProgress={refresh}\n+        />\n+      </div>\n+    </div>\n+  );\n } \n\\ No newline at end of file\n"
                },
                {
                    "date": 1740947975730,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,12 +26,12 @@\n   if (loading) {\n     return <LoadingSpinner />;\n   }\n \n-  if (!tasks || !stats) {\n+  if (error || !tasks || !stats) {\n     return (\n       <div className=\"p-4 bg-red-50 rounded-lg\">\n-        <p className=\"text-red-600\">Failed to load onboarding data</p>\n+        <p className=\"text-red-600\">{error || \"Failed to load onboarding data\"}</p>\n       </div>\n     );\n   }\n \n"
                },
                {
                    "date": 1740948012834,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,9 +75,9 @@\n       {/* Onboarding Steps */}\n       <OnboardingSteps\n         schoolId={schoolId as string}\n         currentStep={stats?.completedTasks || 0}\n-        onStepComplete={refresh}\n+        onStepComplete={updateProgress}\n       />\n \n       {/* Task Progress */}\n       <div className=\"mt-8\">\n"
                },
                {
                    "date": 1740948056864,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n         <div className=\"grid grid-cols-4 gap-4\">\n           <div>\n             <p className=\"text-sm text-gray-600\">Overall Progress</p>\n             <p className=\"text-2xl font-semibold text-primary\">\n-              {Math.round(stats?.progress || 0)}%\n+              {Math.round((stats?.completedTasks / (stats?.totalTasks || 1)) * 100)}%\n             </p>\n           </div>\n           <div>\n             <p className=\"text-sm text-gray-600\">Completed Tasks</p>\n@@ -59,24 +59,24 @@\n           </div>\n           <div>\n             <p className=\"text-sm text-gray-600\">Pending Tasks</p>\n             <p className=\"text-2xl font-semibold text-yellow-600\">\n-              {stats?.pendingTasks || 0}\n+              {(stats?.totalTasks || 0) - (stats?.completedTasks || 0)}\n             </p>\n           </div>\n           <div>\n             <p className=\"text-sm text-gray-600\">Required Remaining</p>\n             <p className=\"text-2xl font-semibold text-red-600\">\n-              {stats?.remainingRequired || 0}\n+              {(stats?.requiredTasks || 0) - (stats?.completedRequiredTasks || 0)}\n             </p>\n           </div>\n         </div>\n       </div>\n \n       {/* Onboarding Steps */}\n       <OnboardingSteps\n         schoolId={schoolId as string}\n-        currentStep={stats?.completedTasks || 0}\n+        completedSteps={stats?.completedTasks || 0}\n         onStepComplete={updateProgress}\n       />\n \n       {/* Task Progress */}\n"
                },
                {
                    "date": 1740948103979,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,10 +74,9 @@\n \n       {/* Onboarding Steps */}\n       <OnboardingSteps\n         schoolId={schoolId as string}\n-        completedSteps={stats?.completedTasks || 0}\n-        onStepComplete={updateProgress}\n+        onComplete={() => refresh()}\n       />\n \n       {/* Task Progress */}\n       <div className=\"mt-8\">\n"
                },
                {
                    "date": 1740948116795,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,9 +65,9 @@\n           </div>\n           <div>\n             <p className=\"text-sm text-gray-600\">Required Remaining</p>\n             <p className=\"text-2xl font-semibold text-red-600\">\n-              {(stats?.requiredTasks || 0) - (stats?.completedRequiredTasks || 0)}\n+              {stats?.remainingRequired || 0}\n             </p>\n           </div>\n         </div>\n       </div>\n"
                },
                {
                    "date": 1740948150461,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,9 +82,9 @@\n       <div className=\"mt-8\">\n         <OnboardingProgress\n           tasks={tasks}\n           progress={progress}\n-          onUpdateProgress={refresh}\n+          onUpdateProgress={updateProgress}\n         />\n       </div>\n     </div>\n   );\n"
                }
            ],
            "date": 1739438105112,
            "name": "Commit-0",
            "content": "\"use client\";\r\n\r\nimport { useEffect } from 'react';\r\nimport { useParams } from 'next/navigation';\r\nimport { useOnboarding } from '@/hooks/useOnboarding';\r\nimport OnboardingProgress from '@/components/OnboardingProgress';\r\nimport { OnboardingSteps  from '@/components/school/OnboardingSteps';\r\nimport { LoadingSpinner } from '@/components/ui/loading-spinner';\r\n\r\nexport default function SchoolOnboardingPage() {\r\n  const { schoolId } = useParams();\r\n  const { \r\n    tasks, \r\n    progress, \r\n    stats, \r\n    loading, \r\n    error,\r\n    updateProgress,\r\n    refresh \r\n  } = useOnboarding(schoolId as string);\r\n\r\n  useEffect(() => {\r\n    refresh();\r\n  }, [schoolId]);\r\n\r\n  if (loading) {\r\n    return <LoadingSpinner />;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-4 bg-red-50 rounded-lg\">\r\n        <p className=\"text-red-600\">{error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto py-8 px-4\">\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">School Onboarding</h1>\r\n        <p className=\"text-gray-600\">Complete these steps to set up your school</p>\r\n      </div>\r\n\r\n      {/* Progress Overview */}\r\n      <div className=\"mb-8 p-4 bg-white rounded-lg shadow\">\r\n        <div className=\"grid grid-cols-4 gap-4\">\r\n          <div>\r\n            <p className=\"text-sm text-gray-600\">Overall Progress</p>\r\n            <p className=\"text-2xl font-semibold text-primary\">\r\n              {Math.round(stats?.progress || 0)}%\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-sm text-gray-600\">Completed Tasks</p>\r\n            <p className=\"text-2xl font-semibold text-green-600\">\r\n              {stats?.completedTasks || 0}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-sm text-gray-600\">Pending Tasks</p>\r\n            <p className=\"text-2xl font-semibold text-yellow-600\">\r\n              {stats?.pendingTasks || 0}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-sm text-gray-600\">Required Remaining</p>\r\n            <p className=\"text-2xl font-semibold text-red-600\">\r\n              {stats?.remainingRequired || 0}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Onboarding Steps */}\r\n      <OnboardingSteps\r\n        schoolId={schoolId as string}\r\n        currentStep={stats?.completedTasks || 0}\r\n        onStepComplete={refresh}\r\n      />\r\n\r\n      {/* Task Progress */}\r\n      <div className=\"mt-8\">\r\n        <OnboardingProgress\r\n          tasks={tasks}\r\n          progress={progress}\r\n          onUpdateProgress={updateProgress}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n} "
        }
    ]
}