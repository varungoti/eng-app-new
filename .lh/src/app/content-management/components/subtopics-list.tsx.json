{
    "sourceFile": "src/app/content-management/components/subtopics-list.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1740947409418,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1740947414920,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,8 @@\n import { toast } from \"sonner\";\r\n \r\n import {\r\n   Card,\r\n-  CardContent,\r\n   CardDescription,\r\n   CardHeader,\r\n   CardTitle,\r\n } from \"@/components/ui/card\";\r\n"
                }
            ],
            "date": 1740947409418,
            "name": "Commit-0",
            "content": "\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { createClientComponentClient } from \"@supabase/auth-helpers-nextjs\";\r\nimport { Trash2 } from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\n\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/card\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Subtopic } from \"../types\";\r\nimport { EditSubtopicDialog } from \"./dialogs/edit-subtopic-dialog\";\r\n\r\ninterface SubtopicsListProps {\r\n  subtopics: Subtopic[];\r\n  selectedSubtopic: Subtopic | null;\r\n  onSelect: (subtopic: Subtopic) => void;\r\n  onUpdate: () => void;\r\n}\r\n\r\nconst supabase = createClientComponentClient({\r\n    supabaseUrl: import.meta.env.VITE_SUPABASE_URL, \r\n    supabaseKey: import.meta.env.VITE_SUPABASE_ANON_KEY,\r\n});\r\n\r\nexport function SubtopicsList({ subtopics, selectedSubtopic, onSelect, onUpdate }: SubtopicsListProps) {\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n\r\n  const handleDelete = async (subtopicId: string) => {\r\n    try {\r\n      setIsDeleting(true);\r\n      const { error } = await supabase\r\n        .from(\"subtopics\")\r\n        .delete()\r\n        .eq(\"id\", subtopicId);\r\n\r\n      if (error) throw error;\r\n\r\n      toast.success(\"Subtopic deleted successfully\");\r\n      onUpdate();\r\n    } catch (error) {\r\n      toast.error(\"Failed to delete subtopic\");\r\n      console.error(error);\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n      {subtopics.map((subtopic) => (\r\n        <Card \r\n          key={subtopic.id}\r\n          className={`cursor-pointer hover:border-primary transition-colors ${\r\n            selectedSubtopic?.id === subtopic.id ? \"border-primary\" : \"\"\r\n          }`}\r\n          onClick={() => onSelect(subtopic)}\r\n        >\r\n          <CardHeader className=\"flex flex-row items-center justify-between\">\r\n            <div>\r\n              <CardTitle>{subtopic.title}</CardTitle>\r\n              <CardDescription>{subtopic.description}</CardDescription>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <EditSubtopicDialog subtopic={subtopic} onSuccess={onUpdate} />\r\n              \r\n              <AlertDialog>\r\n                <AlertDialogTrigger asChild>\r\n                  <Button variant=\"destructive\" size=\"icon\">\r\n                    <Trash2 className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </AlertDialogTrigger>\r\n                <AlertDialogContent>\r\n                  <AlertDialogHeader>\r\n                    <AlertDialogTitle>Delete Subtopic</AlertDialogTitle>\r\n                    <AlertDialogDescription>\r\n                      Are you sure you want to delete this subtopic? This action cannot be undone.\r\n                    </AlertDialogDescription>\r\n                  </AlertDialogHeader>\r\n                  <AlertDialogFooter>\r\n                    <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n                    <AlertDialogAction\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        if (subtopic.id) {\r\n                          handleDelete(subtopic.id);\r\n                        }\r\n                      }}\r\n                      disabled={isDeleting}\r\n                    >\r\n                      {isDeleting ? \"Deleting...\" : \"Delete\"}\r\n                    </AlertDialogAction>\r\n                  </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n              </AlertDialog>\r\n            </div>\r\n          </CardHeader>\r\n        </Card>\r\n      ))}\r\n    </div>\r\n  );\r\n} \r\nexport default SubtopicsList;"
        }
    ]
}