{
    "sourceFile": "src/components/lesson/exercise-prompt-view.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1741213657707,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1741213743099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,12 @@\n // Add a utility to track the last media event\r\n let lastMediaEventTime = 0;\r\n let lastMediaEventId = '';\r\n \r\n+// Track the last media display to prevent duplicates\r\n+let lastMediaTimestamp = 0;\r\n+let lastMediaUrl = '';\r\n+\r\n // Update the mouseEnter handler to prevent rapid firing\r\n const handleMouseEnter = (exercisePrompt: ExercisePrompt) => {\r\n   // Skip if this is the same exercise prompt within a short time window\r\n   const now = Date.now();\r\n@@ -32,5 +36,46 @@\n     }\r\n   });\r\n   \r\n   window.dispatchEvent(mediaEvent);\r\n+};\r\n+\r\n+// Modify the function that triggers media display (around line 70-100)\r\n+// This might be in onMouseEnter or similar event handler\r\n+const dispatchMediaEvent = (exercisePrompt: ExercisePrompt) => {\r\n+  // Skip if no media\r\n+  if (!exercisePrompt?.media) return;\r\n+  \r\n+  // Add timestamp parameter to force refresh and make URL unique\r\n+  const timestamp = Date.now();\r\n+  const mediaUrl = `${exercisePrompt.media}?_t=${timestamp}`;\r\n+  \r\n+  // Prevent duplicate events for the same media within 500ms\r\n+  if (lastMediaUrl === exercisePrompt.media && timestamp - lastMediaTimestamp < 500) {\r\n+    return;\r\n+  }\r\n+  \r\n+  // Update tracking variables\r\n+  lastMediaTimestamp = timestamp;\r\n+  lastMediaUrl = exercisePrompt.media;\r\n+  \r\n+  console.log(`Dispatching displayMediaInRightPanel event:`, {\r\n+    mediaUrl,\r\n+    mediaType: exercisePrompt.type || 'image',\r\n+    mediaTitle: exercisePrompt.text,\r\n+    sourceId: exercisePrompt.id\r\n+  });\r\n+  \r\n+  // Create and dispatch the event\r\n+  const event = new CustomEvent('displayMediaInRightPanel', {\r\n+    detail: {\r\n+      mediaUrl,\r\n+      mediaType: exercisePrompt.type || 'image',\r\n+      mediaTitle: exercisePrompt.text,\r\n+      sourceId: exercisePrompt.id,\r\n+      isExternalDomain: true,\r\n+      isPermanent: true\r\n+    }\r\n+  });\r\n+  \r\n+  window.dispatchEvent(event);\r\n }; \n\\ No newline at end of file\n"
                },
                {
                    "date": 1741213853417,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,37 +7,10 @@\n let lastMediaUrl = '';\r\n \r\n // Update the mouseEnter handler to prevent rapid firing\r\n const handleMouseEnter = (exercisePrompt: ExercisePrompt) => {\r\n-  // Skip if this is the same exercise prompt within a short time window\r\n-  const now = Date.now();\r\n-  if (lastMediaEventId === exercisePrompt.id && now - lastMediaEventTime < 500) {\r\n-    return;\r\n-  }\r\n-  \r\n-  // Update tracking variables\r\n-  lastMediaEventTime = now;\r\n-  lastMediaEventId = exercisePrompt.id;\r\n-\r\n   console.log(\"Mouse entered exercise prompt:\", exercisePrompt.id);\r\n-  \r\n-  if (!exercisePrompt?.media) {\r\n-    return;\r\n-  }\r\n-  \r\n-  // Dispatch an event to display the media\r\n-  const mediaEvent = new CustomEvent('displayMediaInRightPanel', {\r\n-    detail: {\r\n-      mediaUrl: `${exercisePrompt.media}?_t=${now}`,\r\n-      mediaType: exercisePrompt.type || 'image',\r\n-      mediaTitle: exercisePrompt.text,\r\n-      sourceId: exercisePrompt.id,\r\n-      isExternalDomain: true,\r\n-      isPermanent: true\r\n-    }\r\n-  });\r\n-  \r\n-  window.dispatchEvent(mediaEvent);\r\n+  dispatchMediaEvent(exercisePrompt);\r\n };\r\n \r\n // Modify the function that triggers media display (around line 70-100)\r\n // This might be in onMouseEnter or similar event handler\r\n"
                }
            ],
            "date": 1741213657707,
            "name": "Commit-0",
            "content": "// Add a utility to track the last media event\r\nlet lastMediaEventTime = 0;\r\nlet lastMediaEventId = '';\r\n\r\n// Update the mouseEnter handler to prevent rapid firing\r\nconst handleMouseEnter = (exercisePrompt: ExercisePrompt) => {\r\n  // Skip if this is the same exercise prompt within a short time window\r\n  const now = Date.now();\r\n  if (lastMediaEventId === exercisePrompt.id && now - lastMediaEventTime < 500) {\r\n    return;\r\n  }\r\n  \r\n  // Update tracking variables\r\n  lastMediaEventTime = now;\r\n  lastMediaEventId = exercisePrompt.id;\r\n\r\n  console.log(\"Mouse entered exercise prompt:\", exercisePrompt.id);\r\n  \r\n  if (!exercisePrompt?.media) {\r\n    return;\r\n  }\r\n  \r\n  // Dispatch an event to display the media\r\n  const mediaEvent = new CustomEvent('displayMediaInRightPanel', {\r\n    detail: {\r\n      mediaUrl: `${exercisePrompt.media}?_t=${now}`,\r\n      mediaType: exercisePrompt.type || 'image',\r\n      mediaTitle: exercisePrompt.text,\r\n      sourceId: exercisePrompt.id,\r\n      isExternalDomain: true,\r\n      isPermanent: true\r\n    }\r\n  });\r\n  \r\n  window.dispatchEvent(mediaEvent);\r\n}; "
        }
    ]
}