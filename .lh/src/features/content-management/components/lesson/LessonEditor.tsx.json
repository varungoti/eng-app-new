{
    "sourceFile": "src/features/content-management/components/lesson/LessonEditor.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1740085835613,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1740087266273,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,28 +1,32 @@\n-import { Pencil, Save } from 'lucide-react';\r\n-import { Card, CardContent, CardHeader } from '@/components/ui/card';\r\n+import { Pencil, Save, X } from 'lucide-react';\r\n+import { Card, CardContent, CardHeader, CardDescription } from '@/components/ui/card';\r\n import { Button } from '@/components/ui/button';\r\n import { Label } from '@/components/ui/label';\r\n import { RichTextEditor } from '@/components/ui/rich-text-editor';\r\n import { InlineEdit } from '../shared/InlineEdit';\r\n-import { SaveStatus } from '../../api/types';\r\n+import { SaveProgress } from '../../hooks/useLessonEditor';\r\n+import { Badge } from '@/components/ui/badge';\r\n+import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\n+import { cn } from '@/lib/utils';\r\n \r\n interface LessonEditorProps {\r\n   lessonTitle: string;\r\n   contentHeading: string;\r\n   lessonContent: string;\r\n   isContentEditorOpen: boolean;\r\n   isEditingTitle: boolean;\r\n   isEditingHeading: boolean;\r\n-  saveProgress: SaveStatus['status'];\r\n+  saveProgress: SaveProgress;\r\n   onTitleChange: (title: string) => void;\r\n   onHeadingChange: (heading: string) => void;\r\n   onContentChange: (content: string) => void;\r\n   onContentSave: (content: string) => void;\r\n   setIsContentEditorOpen: (isOpen: boolean) => void;\r\n   setIsEditingTitle: (isEditing: boolean) => void;\r\n   setIsEditingHeading: (isEditing: boolean) => void;\r\n   onSave: () => void;\r\n+  className?: string;\r\n }\r\n \r\n export const LessonEditor = ({\r\n   lessonTitle,\r\n@@ -39,45 +43,62 @@\n   setIsContentEditorOpen,\r\n   setIsEditingTitle,\r\n   setIsEditingHeading,\r\n   onSave,\r\n+  className\r\n }: LessonEditorProps) => {\r\n   return (\r\n-    <Card>\r\n+    <Card className={cn(\"relative\", className)}>\r\n       <CardHeader>\r\n         <div className=\"flex items-center justify-between mb-4\">\r\n-          <h2 className=\"text-2xl font-bold\">Lesson Content</h2>\r\n-          <Button\r\n-            variant=\"outline\"\r\n-            size=\"sm\"\r\n-            onClick={() => setIsContentEditorOpen(true)}\r\n-          >\r\n-            <Pencil className=\"h-4 w-4 mr-2\" />\r\n-            Edit Content\r\n-          </Button>\r\n+          <div className=\"space-y-1 flex-1\">\r\n+            <div className=\"flex items-center gap-4\">\r\n+              <InlineEdit\r\n+                value={lessonTitle}\r\n+                onSave={onTitleChange}\r\n+                isEditing={isEditingTitle}\r\n+                setIsEditing={setIsEditingTitle}\r\n+                placeholder=\"Enter lesson title\"\r\n+                className=\"text-2xl font-bold\"\r\n+              />\r\n+              <Badge variant={saveProgress === 'saved' ? 'secondary' : 'outline'}>\r\n+                {saveProgress === 'saving' ? 'Saving...' : saveProgress === 'saved' ? 'Saved' : 'Draft'}\r\n+              </Badge>\r\n+            </div>\r\n+            <CardDescription>\r\n+              Create and manage your lesson content, including the main content and heading.\r\n+            </CardDescription>\r\n+          </div>\r\n+          <div className=\"flex items-center gap-2\">\r\n+            <TooltipProvider>\r\n+              <Tooltip>\r\n+                <TooltipTrigger asChild>\r\n+                  <Button\r\n+                    variant=\"outline\"\r\n+                    size=\"sm\"\r\n+                    onClick={() => setIsContentEditorOpen(true)}\r\n+                    disabled={isContentEditorOpen}\r\n+                  >\r\n+                    <Pencil className=\"h-4 w-4 mr-2\" />\r\n+                    Edit Content\r\n+                  </Button>\r\n+                </TooltipTrigger>\r\n+                <TooltipContent>\r\n+                  Open the content editor to modify lesson content\r\n+                </TooltipContent>\r\n+              </Tooltip>\r\n+            </TooltipProvider>\r\n+          </div>\r\n         </div>\r\n       </CardHeader>\r\n-      <CardContent className=\"space-y-4\">\r\n-        {/* Lesson Title */}\r\n-        <div className=\"flex items-center justify-between\">\r\n-          <div className=\"space-y-1\">\r\n-            <Label>Lesson Title</Label>\r\n-            <InlineEdit\r\n-              value={lessonTitle}\r\n-              onSave={onTitleChange}\r\n-              isEditing={isEditingTitle}\r\n-              setIsEditing={setIsEditingTitle}\r\n-              placeholder=\"Enter lesson title\"\r\n-              className=\"text-lg font-medium\"\r\n-            />\r\n-          </div>\r\n-        </div>\r\n \r\n+      <CardContent className=\"space-y-6\">\r\n         {/* Content Editor and Display */}\r\n         <div className=\"space-y-4\">\r\n           {isContentEditorOpen ? (\r\n-            <div className=\"border rounded-lg p-4\">\r\n-              <div className=\"mb-4\">\r\n+            <div className=\"border rounded-lg p-4 space-y-4\">\r\n+              {/* Content Heading */}\r\n+              <div className=\"space-y-2\">\r\n                 <Label>Content Heading</Label>\r\n                 <InlineEdit\r\n                   value={contentHeading}\r\n                   onSave={onHeadingChange}\r\n@@ -86,23 +107,36 @@\n                   placeholder=\"Add content heading\"\r\n                   className=\"text-base text-muted-foreground\"\r\n                 />\r\n               </div>\r\n-              <RichTextEditor\r\n-                value={lessonContent}\r\n-                onChange={onContentChange}\r\n-                onSave={onContentSave}\r\n-                placeholder=\"Add lesson content here...\"\r\n-              />\r\n-              <div className=\"flex justify-end mt-4 gap-2\">\r\n+\r\n+              {/* Rich Text Editor */}\r\n+              <div className=\"space-y-2\">\r\n+                <Label>Lesson Content</Label>\r\n+                <RichTextEditor\r\n+                  value={lessonContent}\r\n+                  onChange={onContentChange}\r\n+                  onSave={onContentSave}\r\n+                  placeholder=\"Add lesson content here...\"\r\n+                />\r\n+              </div>\r\n+\r\n+              {/* Editor Actions */}\r\n+              <div className=\"flex items-center justify-end gap-2 pt-4 border-t\">\r\n                 <Button\r\n                   variant=\"outline\"\r\n+                  size=\"sm\"\r\n                   onClick={() => setIsContentEditorOpen(false)}\r\n                 >\r\n+                  <X className=\"h-4 w-4 mr-2\" />\r\n                   Cancel\r\n                 </Button>\r\n                 <Button\r\n-                  onClick={() => onContentSave(lessonContent)}\r\n+                  size=\"sm\"\r\n+                  onClick={() => {\r\n+                    onContentSave(lessonContent);\r\n+                    setIsContentEditorOpen(false);\r\n+                  }}\r\n                   disabled={saveProgress === 'saving'}\r\n                 >\r\n                   {saveProgress === 'saving' ? (\r\n                     <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" />\r\n@@ -112,35 +146,80 @@\n                   Save Changes\r\n                 </Button>\r\n               </div>\r\n             </div>\r\n-          ) : lessonContent ? (\r\n+          ) : (\r\n             <div className=\"prose prose-sm max-w-none\">\r\n               {contentHeading && (\r\n-                <h3 className=\"text-lg font-semibold mb-2\">{contentHeading}</h3>\r\n+                <h3 className=\"text-lg font-semibold mb-4\">{contentHeading}</h3>\r\n               )}\r\n-              <div dangerouslySetInnerHTML={{ __html: lessonContent }} />\r\n+              {lessonContent ? (\r\n+                <div \r\n+                  dangerouslySetInnerHTML={{ __html: lessonContent }}\r\n+                  className=\"min-h-[200px] p-4 rounded-lg border bg-card\"\r\n+                />\r\n+              ) : (\r\n+                <div className=\"flex items-center justify-center h-[200px] text-muted-foreground border rounded-lg bg-muted/5\">\r\n+                  <p>Click 'Edit Content' to add lesson content</p>\r\n+                </div>\r\n+              )}\r\n             </div>\r\n-          ) : (\r\n-            <div className=\"text-center py-8 text-muted-foreground\">\r\n-              Click 'Edit Content' to add lesson content\r\n-            </div>\r\n           )}\r\n         </div>\r\n \r\n         {/* Save Button */}\r\n-        <Button\r\n-          className=\"mt-4\"\r\n-          onClick={onSave}\r\n-          disabled={saveProgress === 'saving'}\r\n-        >\r\n-          {saveProgress === 'saving' ? (\r\n-            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" />\r\n-          ) : (\r\n-            <Save className=\"h-4 w-4 mr-2\" />\r\n+        <div className=\"flex items-center justify-end gap-4\">\r\n+          <TooltipProvider>\r\n+            <Tooltip>\r\n+              <TooltipTrigger asChild>\r\n+                <Button\r\n+                  onClick={onSave}\r\n+                  disabled={saveProgress === 'saving'}\r\n+                  size=\"sm\"\r\n+                >\r\n+                  {saveProgress === 'saving' ? (\r\n+                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" />\r\n+                  ) : (\r\n+                    <Save className=\"h-4 w-4 mr-2\" />\r\n+                  )}\r\n+                  Save Lesson\r\n+                </Button>\r\n+              </TooltipTrigger>\r\n+              <TooltipContent>\r\n+                Save all lesson changes including title, heading, and content\r\n+              </TooltipContent>\r\n+            </Tooltip>\r\n+          </TooltipProvider>\r\n+        </div>\r\n+      </CardContent>\r\n+\r\n+      {/* Save Progress Indicator */}\r\n+      {saveProgress !== 'idle' && (\r\n+        <div className={cn(\r\n+          \"absolute bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg transition-all duration-200\",\r\n+          saveProgress === 'saving' && \"bg-background border\",\r\n+          saveProgress === 'saved' && \"bg-green-500 text-white\",\r\n+          saveProgress === 'error' && \"bg-destructive text-destructive-foreground\"\r\n+        )}>\r\n+          {saveProgress === 'saving' && (\r\n+            <div className=\"flex items-center gap-2\">\r\n+              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-primary\" />\r\n+              <span className=\"text-sm\">Saving changes...</span>\r\n+            </div>\r\n           )}\r\n-          Save Lesson\r\n-        </Button>\r\n-      </CardContent>\r\n+          {saveProgress === 'saved' && (\r\n+            <div className=\"flex items-center gap-2\">\r\n+              <Save className=\"h-4 w-4\" />\r\n+              <span className=\"text-sm\">Changes saved</span>\r\n+            </div>\r\n+          )}\r\n+          {saveProgress === 'error' && (\r\n+            <div className=\"flex items-center gap-2\">\r\n+              <X className=\"h-4 w-4\" />\r\n+              <span className=\"text-sm\">Error saving changes</span>\r\n+            </div>\r\n+          )}\r\n+        </div>\r\n+      )}\r\n     </Card>\r\n   );\r\n }; \n\\ No newline at end of file\n"
                }
            ],
            "date": 1740085835613,
            "name": "Commit-0",
            "content": "import { Pencil, Save } from 'lucide-react';\r\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport { RichTextEditor } from '@/components/ui/rich-text-editor';\r\nimport { InlineEdit } from '../shared/InlineEdit';\r\nimport { SaveStatus } from '../../api/types';\r\n\r\ninterface LessonEditorProps {\r\n  lessonTitle: string;\r\n  contentHeading: string;\r\n  lessonContent: string;\r\n  isContentEditorOpen: boolean;\r\n  isEditingTitle: boolean;\r\n  isEditingHeading: boolean;\r\n  saveProgress: SaveStatus['status'];\r\n  onTitleChange: (title: string) => void;\r\n  onHeadingChange: (heading: string) => void;\r\n  onContentChange: (content: string) => void;\r\n  onContentSave: (content: string) => void;\r\n  setIsContentEditorOpen: (isOpen: boolean) => void;\r\n  setIsEditingTitle: (isEditing: boolean) => void;\r\n  setIsEditingHeading: (isEditing: boolean) => void;\r\n  onSave: () => void;\r\n}\r\n\r\nexport const LessonEditor = ({\r\n  lessonTitle,\r\n  contentHeading,\r\n  lessonContent,\r\n  isContentEditorOpen,\r\n  isEditingTitle,\r\n  isEditingHeading,\r\n  saveProgress,\r\n  onTitleChange,\r\n  onHeadingChange,\r\n  onContentChange,\r\n  onContentSave,\r\n  setIsContentEditorOpen,\r\n  setIsEditingTitle,\r\n  setIsEditingHeading,\r\n  onSave,\r\n}: LessonEditorProps) => {\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h2 className=\"text-2xl font-bold\">Lesson Content</h2>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setIsContentEditorOpen(true)}\r\n          >\r\n            <Pencil className=\"h-4 w-4 mr-2\" />\r\n            Edit Content\r\n          </Button>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Lesson Title */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"space-y-1\">\r\n            <Label>Lesson Title</Label>\r\n            <InlineEdit\r\n              value={lessonTitle}\r\n              onSave={onTitleChange}\r\n              isEditing={isEditingTitle}\r\n              setIsEditing={setIsEditingTitle}\r\n              placeholder=\"Enter lesson title\"\r\n              className=\"text-lg font-medium\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content Editor and Display */}\r\n        <div className=\"space-y-4\">\r\n          {isContentEditorOpen ? (\r\n            <div className=\"border rounded-lg p-4\">\r\n              <div className=\"mb-4\">\r\n                <Label>Content Heading</Label>\r\n                <InlineEdit\r\n                  value={contentHeading}\r\n                  onSave={onHeadingChange}\r\n                  isEditing={isEditingHeading}\r\n                  setIsEditing={setIsEditingHeading}\r\n                  placeholder=\"Add content heading\"\r\n                  className=\"text-base text-muted-foreground\"\r\n                />\r\n              </div>\r\n              <RichTextEditor\r\n                value={lessonContent}\r\n                onChange={onContentChange}\r\n                onSave={onContentSave}\r\n                placeholder=\"Add lesson content here...\"\r\n              />\r\n              <div className=\"flex justify-end mt-4 gap-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setIsContentEditorOpen(false)}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n                <Button\r\n                  onClick={() => onContentSave(lessonContent)}\r\n                  disabled={saveProgress === 'saving'}\r\n                >\r\n                  {saveProgress === 'saving' ? (\r\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" />\r\n                  ) : (\r\n                    <Save className=\"h-4 w-4 mr-2\" />\r\n                  )}\r\n                  Save Changes\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          ) : lessonContent ? (\r\n            <div className=\"prose prose-sm max-w-none\">\r\n              {contentHeading && (\r\n                <h3 className=\"text-lg font-semibold mb-2\">{contentHeading}</h3>\r\n              )}\r\n              <div dangerouslySetInnerHTML={{ __html: lessonContent }} />\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              Click 'Edit Content' to add lesson content\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Save Button */}\r\n        <Button\r\n          className=\"mt-4\"\r\n          onClick={onSave}\r\n          disabled={saveProgress === 'saving'}\r\n        >\r\n          {saveProgress === 'saving' ? (\r\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" />\r\n          ) : (\r\n            <Save className=\"h-4 w-4 mr-2\" />\r\n          )}\r\n          Save Lesson\r\n        </Button>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}; "
        }
    ]
}